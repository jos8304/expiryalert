{"ast":null,"code":"import{useState}from'react';import useTranslate from'../hooks/useTranslate';import FileInput from'./FileInput';import'./FoodForm.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function sanitize(type,value){switch(type){case'number':return Number(value)||0;default:return value;}}const INITIAL_VALUES={imgFile:null,title:'',calorie:0,content:''};function FoodForm(_ref){let{initialValues=INITIAL_VALUES,initialPreview,onSubmit,onSubmitSuccess,onCancel}=_ref;const t=useTranslate();const[isSubmitting,setIsSubmitting]=useState(false);const[submittingError,setSubmittingError]=useState(null);const[values,setValues]=useState(initialValues);const handleSubmit=async e=>{e.preventDefault();const formData=new FormData();formData.append('imgFile',values.imgFile);formData.append('title',values.title);formData.append('calorie',values.calorie);formData.append('content',values.content);let result;try{setSubmittingError(null);setIsSubmitting(true);result=await onSubmit(formData);}catch(error){setSubmittingError(error);return;}finally{setIsSubmitting(false);}const{food}=result;setValues(initialValues);onSubmitSuccess(food);};const handleChange=(name,value)=>{setValues(prevValues=>({...prevValues,[name]:value}));};const handleInputChange=e=>{const{name,value,type}=e.target;handleChange(name,sanitize(type,value));};return/*#__PURE__*/_jsxs(\"form\",{className:\"FoodForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FileInput,{className:\"FoodForm-preview\",name:\"imgFile\",initialPreview:initialPreview,value:values.imgFile,onChange:handleChange}),/*#__PURE__*/_jsxs(\"div\",{className:\"FoodForm-rows\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"FoodForm-title-calorie\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"FoodForm-title\",name:\"title\",value:values.title,placeholder:t('title placeholder'),onChange:handleInputChange}),/*#__PURE__*/_jsx(\"input\",{className:\"FoodForm-calorie\",type:\"number\",name:\"calorie\",value:values.calorie,placeholder:t('calorie placeholder'),onChange:handleInputChange}),onCancel&&/*#__PURE__*/_jsx(\"button\",{className:\"FoodForm-cancel-button\",type:\"button\",onClick:onCancel,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"FoodForm-submit-button\",type:\"submit\",disabled:isSubmitting,children:\"\\uD655\\uC778\"})]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"FoodForm-content\",name:\"content\",value:values.content,placeholder:\"\\uB0B4\\uC6A9\\uC744 \\uC791\\uC131\\uD574 \\uC8FC\\uC138\\uC694.\",onChange:handleInputChange}),submittingError&&/*#__PURE__*/_jsx(\"p\",{children:submittingError.message})]})]});}export default FoodForm;","map":{"version":3,"names":["useState","useTranslate","FileInput","jsx","_jsx","jsxs","_jsxs","sanitize","type","value","Number","INITIAL_VALUES","imgFile","title","calorie","content","FoodForm","_ref","initialValues","initialPreview","onSubmit","onSubmitSuccess","onCancel","t","isSubmitting","setIsSubmitting","submittingError","setSubmittingError","values","setValues","handleSubmit","e","preventDefault","formData","FormData","append","result","error","food","handleChange","name","prevValues","handleInputChange","target","className","children","onChange","placeholder","onClick","disabled","message"],"sources":["C:/Users/jos83/project/expiryalert/src/components/FoodForm.js"],"sourcesContent":["import { useState } from 'react';\nimport useTranslate from '../hooks/useTranslate';\nimport FileInput from './FileInput';\nimport './FoodForm.css';\n\nfunction sanitize(type, value) {\n  switch (type) {\n    case 'number':\n      return Number(value) || 0;\n\n    default:\n      return value;\n  }\n}\n\nconst INITIAL_VALUES = {\n  imgFile: null,\n  title: '',\n  calorie: 0,\n  content: '',\n};\n\nfunction FoodForm({\n  initialValues = INITIAL_VALUES,\n  initialPreview,\n  onSubmit,\n  onSubmitSuccess,\n  onCancel,\n}) {\n  const t = useTranslate();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submittingError, setSubmittingError] = useState(null);\n  const [values, setValues] = useState(initialValues);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append('imgFile', values.imgFile);\n    formData.append('title', values.title);\n    formData.append('calorie', values.calorie);\n    formData.append('content', values.content);\n    let result;\n    try {\n      setSubmittingError(null);\n      setIsSubmitting(true);\n      result = await onSubmit(formData);\n    } catch (error) {\n      setSubmittingError(error);\n      return;\n    } finally {\n      setIsSubmitting(false);\n    }\n    const { food } = result;\n    setValues(initialValues);\n    onSubmitSuccess(food);\n  };\n\n  const handleChange = (name, value) => {\n    setValues((prevValues) => ({\n      ...prevValues,\n      [name]: value,\n    }));\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value, type } = e.target;\n    handleChange(name, sanitize(type, value));\n  };\n\n  return (\n    <form className=\"FoodForm\" onSubmit={handleSubmit}>\n      <FileInput\n        className=\"FoodForm-preview\"\n        name=\"imgFile\"\n        initialPreview={initialPreview}\n        value={values.imgFile}\n        onChange={handleChange}\n      />\n      <div className=\"FoodForm-rows\">\n        <div className=\"FoodForm-title-calorie\">\n          <input\n            className=\"FoodForm-title\"\n            name=\"title\"\n            value={values.title}\n            placeholder={t('title placeholder')}\n            onChange={handleInputChange}\n          />\n          <input\n            className=\"FoodForm-calorie\"\n            type=\"number\"\n            name=\"calorie\"\n            value={values.calorie}\n            placeholder={t('calorie placeholder')}\n            onChange={handleInputChange}\n          />\n          {onCancel && (\n            <button\n              className=\"FoodForm-cancel-button\"\n              type=\"button\"\n              onClick={onCancel}\n            >\n              취소\n            </button>\n          )}\n          <button\n            className=\"FoodForm-submit-button\"\n            type=\"submit\"\n            disabled={isSubmitting}\n          >\n            확인\n          </button>\n        </div>\n        <textarea\n          className=\"FoodForm-content\"\n          name=\"content\"\n          value={values.content}\n          placeholder=\"내용을 작성해 주세요.\"\n          onChange={handleInputChange}\n        />\n        {submittingError && <p>{submittingError.message}</p>}\n      </div>\n    </form>\n  );\n}\n\nexport default FoodForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}